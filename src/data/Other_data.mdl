include ..\model\lists

### From producer block

phi_MGPD[cc, c] := PMGPD[cc, c] * MGPD[cc, c] / (sum(PMGPD[ccc, c] * MGPD[ccc, c] on ccc))
phi_MGPM[cc, c] := PMGPM[cc, c] * MGPM[cc, c] / (sum(PMGPM[ccc, c] * MGPM[ccc, c] on ccc))


phi[f, s] := C[f, s] * F_n[f, s] / (sum(C[ff, s] * F_n[ff, s] on ff))

phi[E, ce, s] := PCI[ce, s]*CI[ce, s] / (sum(PCI[cee, s]*CI[cee, s] on cee))

phi_TRSP[ct, s] := PCI[ct, s]*CI[ct, s] / (sum(PCI[ctt, s]*CI[ctt, s] on ctt))

F[K] := sum(F[K, s] on s)
F[L] := sum(F[L, s] on s)
F[E] := sum(F[E, s] on s)
F[MAT] := sum(F[MAT, s] on s)

### From GOV:
NTAXPD_VAL[c] := RNTAXPD[c]*PYQ[c]*YQ[c]

NTAXPM_VAL[c] := RNTAXPM[c]*PM[c]*M[c]

NTAXI_VAL[s] := RNTAXI[s]*PY[s]*Y[s]

RSSC := sum(RSSC[s] on s)

RRSSC := PRSSC * RSSC / (W * F[L]) 

### From Demographic block
Un := LF - Empl
UnR := Un / LF


### From consumer
DISPINC_BT_VAL := PWAGES * WAGES + PROP_INC_H_VAL + SOC_BENF_VAL + TRSF_HH_VAL

DISPINC_AT_VAL := DISPINC_BT_VAL - INC_SOC_TAX_VAL

NCH := sum(NCH[c] on c)

PCH_CES := (sum(@elem(phi_MCH[c], %baseyear) * PCH[c] ^ (1 - ES_LESCES) on c)) ^ (1 / (1 - ES_LESCES))

Phi_CH[c] := CH[c]/CH

SAVH := DISPINC_AT_VAL - PCH * CH

# Households savings rate
RSAVH := SAVH / DISPINC_AT_VAL
