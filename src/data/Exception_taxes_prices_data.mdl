include ..\model\lists

R2_CI[ghg,c,s] 	:= 0 * (1 + GR_PRICES) ^ (@year - %baseyear)
R2_MAT[ghg,s] 	:= 0 * (1 + GR_PRICES) ^ (@year - %baseyear)
R2_Y[ghg,s] 	:= 0 * (1 + GR_PRICES) ^ (@year - %baseyear)
R2_CH[ghg,c] 	:= 0 * (1 + GR_PRICES) ^ (@year - %baseyear)

##### Carbon tax

#### Incomes generated by the carbon tax by type of emissions, sector and commodity

### Incomes generated by intermediary consumption emissions

##! Carbon tax in value on intermediary consumption emissions depending on ghg emission types, commodity c in sector s
T2VAL_CI[ghg,c,s] := R2_CI[ghg,c,s] * EMS_CI[ghg,c,s]

##! Carbon tax in volume on intermediary consumption emissions depending on ghg emission types, commodity c in sector s
T2_CI[ghg,c,s] := @elem(R2_CI[ghg,c,s],%baseyear) * EMS_CI[ghg,c,s]

##! Carbon tax in value on intermediary consumption emissions depending on ghg emission types and commodity c
T2VAL_CI[ghg,c] := sum(T2VAL_CI[ghg,c,s] on s)

##! Carbon tax in value on intermediary consumption emissions depending on ghg emission types and domestic commodity c
T2VAL_CID[ghg,c] := sum(T2VAL_CI[ghg,c,s] * CID[c,s] / (CI[c,s] + eps)  on s)

##! Carbon tax in volume on intermediary consumption emissions depending on $ghg$ emission types and domestic commodity $c$
T2_CID[ghg,c] := sum(T2_CI[ghg,c,s] * CID[c,s] / (CI[c,s] + eps)  on s)

##! Carbon tax in value on intermediary consumption emissions depending on $ghg$ emission types and imported commodity $c$
T2VAL_CIM[ghg,c] := sum(T2VAL_CI[ghg,c,s] * CIM[c,s] / (CI[c,s] + eps) on s)

##! Carbon tax in volume on intermediary consumption emissions depending on $ghg$ emission types and imported commodity $c$
T2_CIM[ghg,c] := sum(T2_CI[ghg,c,s] * CIM[c,s] / (CI[c,s] + eps)  on s)

##! Carbon tax in value on intermediary consumption emissions depending on ghg emission types and sector s
T2VAL_CI[ghg,s] := sum(T2VAL_CI[ghg,c,s] on c)

##! Carbon tax in value on intermediary consumption emissions depending on commodity c and sector s
T2VAL_CI[c,s] := sum(T2VAL_CI[ghg,c,s] on ghg)

##! Carbon tax in value on intermediary consumption emissions depending on ghg emission types
T2VAL_CI[ghg] := sum(T2VAL_CI[ghg,c] on c)

##! Carbon tax in value on intermediary consumption emissions depending on commodity c
T2VAL_CI[c] := sum(T2VAL_CI[ghg,c] on ghg)

##! Carbon tax in value on intermediary consumption emissions depending on domestic commodity c
T2VAL_CID[c] := sum(T2VAL_CID[ghg,c] on ghg)

##! Carbon tax in volume on intermediary consumption emissions depending on domestic commodity c
T2_CID[c] := sum(T2_CID[ghg,c] on ghg)

##! Carbon tax in value on intermediary consumption emissions depending on imported commodity c
T2VAL_CIM[c] := sum(T2VAL_CIM[ghg,c] on ghg)

##! Carbon tax in volume on intermediary consumption emissions depending on imported commodity c
T2_CIM[c] := sum(T2_CIM[ghg,c] on ghg)

##! Carbon tax in value on intermediary consumption emissions depending on sector s
T2VAL_CI[s] := sum(T2VAL_CI[ghg,s] on ghg)

##! Carbon tax in value on intermediary consumption emissions
T2VAL_CI := sum(T2VAL_CI[s] on s)

### Incomes generated by production emissions, intermediary consumption emissions and material emissions

##! Total carbon tax in value collected depending on sector s
T2VAL_SEC[s] := T2VAL_Y[s] + T2VAL_CI[s] + T2VAL_MAT[s]

##! Total carbon tax in value collected over firms
T2VAL_SEC := sum(T2VAL_SEC[s] on s)

### Incomes generated by material emissions

##! Carbon tax in value on material emissions depending on ghg emission types, commodity c in sector s
T2VAL_MAT[ghg,s] := R2_MAT[ghg,s] * EMS_MAT[ghg,s]

##! Carbon tax in volume on material emissions depending on ghg emission types, commodity c in sector s
T2_MAT[ghg,s] := @elem(R2_MAT[ghg,s], %baseyear) * EMS_MAT[ghg,s]

##! Carbon tax in value on material emissions depending on ghg emission types
T2VAL_MAT[ghg] := sum(T2VAL_MAT[ghg,s] on s)

##! Carbon tax in volume on material emissions depending on ghg emission types
T2_MAT[ghg] := sum(T2_MAT[ghg,s] on s)

##! Carbon tax in value on material emissions depending on commodity c
T2VAL_MAT[s] := sum(T2VAL_MAT[ghg,s] on ghg)

##! Carbon tax in volume on material emissions depending on commodity c
T2_MAT[s] := sum(T2_MAT[ghg,s] on ghg)

##! Carbon tax in value on material emissions
T2VAL_MAT := sum(T2VAL_MAT[s] on s)

### Incomes generated by production emissions

##! Carbon tax in value on production emissions depending on ghg emission types, commodity c in sector s
T2VAL_Y[ghg,s] := R2_Y[ghg,s] * EMS_Y[ghg,s]

##! Carbon tax in volume on production emissions depending on ghg emission types, commodity c in sector s
T2_Y[ghg,s] := @elem(R2_Y[ghg,s], %baseyear) * EMS_Y[ghg,s]

##! Carbon tax in value on production emissions depending on ghg emission types
T2VAL_Y[ghg] := sum(T2VAL_Y[ghg,s] on s)

##! Carbon tax in volume on production emissions depending on ghg emission types
T2_Y[ghg] := sum(T2_Y[ghg,s] on s)

##! Carbon tax in value on production emissions depending on sector s
T2VAL_Y[s] := sum(T2VAL_Y[ghg,s] on ghg)

##! Carbon tax in volume on production emissions depending on sector s
T2_Y[s] := sum(T2_Y[ghg,s] on ghg)

##! Carbon tax in value on production emissions
T2VAL_Y := sum(T2VAL_Y[s] on s)

### Incomes generated by households' emissions

##! Carbon tax in value on households' consumption depending on ghg emission types and commodity c
T2VAL_CH[ghg,c] := R2_CH[ghg,c] * EMS_CH[ghg,c]

##! Carbon tax in volume on households' consumption depending on ghg emission types and commodity c
T2_CH[ghg,c] := @elem(R2_CH[ghg,c],%baseyear) * EMS_CH[ghg,c]

##! Carbon tax in value on households' consumption depending on ghg emission types
T2VAL_CH[ghg] := sum(T2VAL_CH[ghg,c] on c)

##! Carbon tax in value on households' consumption depending on commodity c
T2VAL_CH[c] := sum(T2VAL_CH[ghg,c] on ghg)

##! Carbon tax in volume on households' consumption depending on commodity c
T2_CH[c] := sum(T2_CH[ghg,c] on ghg)

##! Carbon tax in value on households' consumption depending on ghg emission types and commodity c
T2VAL_CH := sum(T2VAL_CH[c] on c)


# Special data (inversion of eq. / modification of the equation)

RVATD[c] := VATD[c] / (CHD[c] - VATD[c] + eps)

ROTHCTD[c] := OTHCTD[c] / (YQ[c] + eps)

RVATM[c] := VATM[c] / (CHM[c] - VATM[c] + eps)

ROTHCTM[c] := OTHCTM[c] / (M[c] + eps)

# Subsidy on quantities: the rate increases (in absolute value!) with the price (necessary for a steady state)
RSUBCD[c] := SUBCD[c] / (YQ[c] + eps) * P

RSUBCM[c] := SUBCM[c] / (M[c] + eps) * P

YQSBVAT[c] := YQ[c] + OTHCTD[c] + SUBCD[c] + MGPD[c]
MSBVAT[c] :=  M[c] + OTHCTM[c] + SUBCM[c] + MGPM[c]

## Directly from equations
VATD := sum(VATD[c] on c)
OTHCTD := sum(OTHCTD[c] on c)
SUBCD := sum(SUBCD[c] on c)

VATM := sum(VATM[c] on c)
OTHCTM := sum(OTHCTM[c] on c)
SUBCM := sum(SUBCM[c] on c)

VAT := VATD + VATM
OTHCT := OTHCTD + OTHCTM
SUBC := SUBCD + SUBCM

RVATD := (PVATD * VATD) / (PCHD * CHD - PVATD   * VATD)

ROTHCTD := POTHCTD * OTHCTD / (PYQ * YQ)

RSUBCD := PSUBCD  * SUBCD / YQ

RVATM := (PVATM * VATM) / (PCHM * CHM - PVATM * VATM)

ROTHCTM := POTHCTM * OTHCTM / (PM * M)

RSUBCM := PSUBCM  * SUBCM / M

RVAT := (PVAT * VAT) / (PCH * CH - PVAT   * VAT)

ROTHCT := POTHCT * OTHCT / (PYQ * YQ + PM * M)

RSUBC := PSUBC  * SUBC / (YQ  + M)
