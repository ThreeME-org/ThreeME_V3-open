########################################################
#########     VERIFICATION  #####################
########################################################
### This file provides the equations defining check variables
### Check variables begins with verif. They should always be equal to zero in the calibration and in the simulation.

verif_phi_F[s] = 1 - (sum(phi[ff, s] on ff))

verif_phi_MGPD[c] = 1 - (sum(phi_MGPD[cc, c] on cc)) if MGPD[c] <> 0
verif_phi_MGPM[c] = 1 - (sum(phi_MGPM[cc, c] on cc)) if MGPM[c] <> 0

verif_phi[E, s] = 1 - (sum(phi[E, ce, s] on ce)) if F[E, s] <> 0

verif_phi_TRSP[s] = 1 - (sum(phi_TRSP[ct, s] on ct)) if TRSP[s] <> 0

Verif_PCH_CES = PCH - PCH_CES  if ES_LESCES <> 1

Verif_phi_MCH = sum(phi_MCH[c] on c) - 1

Verif_phi_CH = sum(phi_CH[c] on c) - 1




Verif_ALL = ( sum(verif_phi_F[s]^2 on s) + sum(verif_phi_MGPD[c]^2 on c) + sum(verif_phi_MGPM[c]^2 on c) + sum(verif_phi[E, s]^2 on s) + sum(verif_phi_TRSP[s]^2 on s) + Verif_PCH_CES^2 +Verif_phi_MCH^2 + Verif_phi_CH^2 )^(1/2)



### Verification for the actual elasticities
## The series should converge asymptotically to the inputed elasticities.

ES_act_|V|M[c] = ES_|V|M[c] _ 
					- (P|V|D[c]/P|V|M[c] < 0.99999) * (log(|V|D[c]/|V|M[c]/@elem(|V|D[c]/|V|M[c], %baseyear)) / log(P|V|D[c]/P|V|M[c]) + ES_|V|M[c]) _
					- (P|V|D[c]/P|V|M[c] > 1.00001) * (log(|V|D[c]/|V|M[c]/@elem(|V|D[c]/|V|M[c], %baseyear)) / log(P|V|D[c]/P|V|M[c]) + ES_|V|M[c]) if |V|M[c] <> 0 where V in MGR CH G X

Verif_ES_|V|M[c] = ES_act_|V|M[c] - ES_|V|M[c] where V in MGR CH G X

#ES_act[f, K, s] = ES[f, K, s] - (C[f, s]/PROG[f, s]/(C[K, s]/PROG[K, s])/ @elem(C[f, s]/PROG[f, s]/(C[K, s]/PROG[K, s]), %baseyear) <> 1) * (1)

					#(log(F[f, s]*PROG[f, s]/(F[K, s]*PROG[K, s])/ @elem(F[f, s]*PROG[f, s]/(F[K, s]*PROG[K, s], %baseyear)))/ log(C[f, s]/PROG[f, s]/(C[K, s]/PROG[K, s])/ @elem(C[f, s]/PROG[f, s]/(C[K, s]/PROG[K, s]), %baseyear)) + ES[f, K, s]) 



Verif_ALL_ES = ( sum(Verif_ES_MGRM[c]^2 on c) + sum(Verif_ES_CHM[c]^2 on c) + sum(Verif_ES_GM[c]^2 on c) + sum(Verif_ES_XM[c]^2 on c))^(1/2) where V in MGR CH G X


