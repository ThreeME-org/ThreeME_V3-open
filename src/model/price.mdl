########################################################
#########         PRICES         #####################
########################################################
### This file provides the equations defining the prices.

### Domestic production price of commodity c:
PYQ[c] * YQ[c] = sum(PY[s] * Y[c, s] if Y[c, s] <> 0 on s) if YQ[c] <> 0

### Notional production price of sector s 

PY_n[s] = CU_n[s] * (1 + TMD[s])


#
## equation 5.5
#d(log(1+TMD_n[s])) = STEADYSTATE(49,1) * ( d(log(Y[s])) - d(log(Y[s]{-1})) ) if Y[s] > 0
#
## From v1, rigidities on mark-up adjustments
#TMD[s] = ADJUST(75, 1) * TMD_n[s] + (1 - ADJUST(75, 1)) * TMD[s]{-1} if Y[s] > 0
#
## equation 5.6
#d(log(YOPT[s])) = d(log(K[s])) * CK[s]{-1} * K[s]{-1} / (CU[s]{-1} * Y[s]{-1}) _
#		+ d(log(L[s] * PROG_L[s])) * CL[s]{-1} * L[s]{-1} * PROG_L[s]{-1} / (CU[s]{-1} * Y[s]{-1}) _
#		+ d(log(E[s] + (E[s] >= 0) * (E[s] <= 0) * 0.0000000001)) * PE[s]{-1} * E[s]{-1} / (CU[s]{-1} * Y[s]{-1}) _
#		+ d(log(MAT[s])) * PMAT[s]{-1} * MAT[s]{-1} / (CU[s]{-1} * Y[s]{-1}) _
#		  if YOPT[s] <> 0
#


#equation average mark-up of activities per commodities
#
#(1 + MARKUP[c]) = PYQ[c] * YQ[c] / (sum(NCU_n[s] * Y[c, s] if Y[c, s] <> 0 on s)) if YQ[c] <> 0








## Notional unit cost of production in sector s
## To define the notional price, it is preferable to use the notional unit cost of production insteard of the effective one. This lead to a more stable dynamic and gives a better representation of anticipation.

CU_n[s] * Y[s] = CK[s] * K_n[s] + CL[s] * L_n[s] * PROG_L[s] + PE[s] * E_n[s] + PMAT[s]*MAT_n[s] + NTAXP_VAL[s]

## Unit cost of production in sector s
CU[s]*Y[s] = CK[s]*K[s] + CL[s]*L[s]*PROG_L[s] + PE[s]*E[s] + PMAT[s]*MAT[s] + NTAXP_VAL[s]

## Labor cost in sector s
CL[s] =  W[s] / PROG_L[s]

### Capital cost in sector s
### It is preferable to calculate the user cost of capital based on the price of capital rather than on the price of investment. Indeed the price of the average capital installed is lower than the one of investment because of inflation. Using the price of investment tend to over estimate the cost of capital because it assumes that the debt contracted to finance past investments is indexed on inflation which is not the case in reality. 

CK[s] = PK[s] * (Tdec[s] + r[s])
 
### Price of capital in sector s
### The price of capital is calibrated by rewriting this equation in the long run. It is always smaller than 1 because it is calibrated as follows: PK[s] = PI[s]*(Tdec[s]+GR_REAL)*(1+GR_PRICES)/(Tdec[s]-1+(1+GR_REAL)*(1+GR_PRICES))

PK[s] * K[s] = (1 - Tdec[s]) * PK[s]{-1} * K[s]{-1} + PI[s] * I[s]

### Volume and price of the super bruto wages paid by sector s (including employees and employers' social contribution) 
### To derive the volume, we assume that the price is the consumer price 

WAGES[s] * PWAGES[s] = W[s] * L[s]

PWAGES[s] = P


### Material consumption price for sector s
PMAT[s]*MAT[s] = sum(PCI[cm, s]*CI[cm, s] if CI[cm, s] <> 0 on cm) if MAT[s] <> 0

### Energy price for sector s
PE[s]*E[s] = sum(PCI[ce, s]*CI[ce, s] if CI[ce, s] <> 0 on ce) if E[s] <> 0


### Average selling price for domestic commodity c

## Y QSc is the volume of the production expressed at market price before VAT. It should not be seen as a composite of several "goods": production at base price and margins. Indeed, its does not increase when the volume of the commercial and transport margins increase. The price does instead. Its speciation is hich is equivalent to 5.18, that is to assuming that Y QSc is always proportionnal to Y Qc. Writing it following the specification composite of several goods, would lead to inacurate results since a decrease in the quantity of transport used per unit of production would not lead to a decrease of the selling price. Notice that the similarity with the specification of the volume of a tax or a subvention. As specified earlier, we assume that an increase in the tax rate does not increase the volume of the tax but increases its price. The volume of the tax increases only when the volume of the taxe bases (e.g. consumption, production) increases.

PYQS[c]*YQS[c] = PYQ[c]*YQ[c] + NTAXCD_VAL[c] + PMGPD[c]*MGPD[c]


		YQS[c] = YQ[c] + NTAXCD[c] + MGPD[c]

# Should be Equivalent to

		d(log(YQSbis[c])) = d(log(YQ[c]))
		

### Net taxes on commodity c domestically produced
### Non trivial: le taux peux être définit de 2 manières. !!!!!!
### Aucune de ces equations ne dois être utilisée pour contruire des données   !!!!!
NTAXCD_VAL[c] = RNTAXCD[c]*PYQ[c]*YQ[c]

	NTAXCD[c] = RNTAXCD[c]*YQ[c]



### Average selling price for imported commodity c

PMS[c]*MS[c] = PM[c]*M[c] + NTAXCM_VAL[c] + PMGPM[c]*MGPM[c] 


       MS[c] = M[c] + NTAXCM[c] + MGPM[c] 


# Should be Equivalent to

		d(log(MSbis[c])) = d(log(M[c]))


### Net taxes on imported commodity c 
### Non trivial: le taux peux être définit de 2 manières. !!!!!!
### Aucune de ces equations ne dois être utilisée pour contruire des données   !!!!!
NTAXCM_VAL[c] = RNTAXCM[c]*PM[c]*M[c]

	NTAXCM[c] = RNTAXCM[c]*M[c]





#
## equation 5.22 & 5.24
#PMAT|O|[cm] = P|V|S[cm] * (1 + Tvat|O|oth[cm]) / (1 + @elem(Tvat|O|oth[cm], %baseyear)) if CI|O|[cm] <> 0 where (O, V) in (D M, YQ M)
#
## equation 5.23 & 5.25
#PE|O|[ce] = P|V|S[ce] * (1 + Tvat|O|oth[ce]) / (1 + @elem(Tvat|O|oth[ce], %baseyear)) if CI|O|[ce] <> 0 where (O, V) in (D M, YQ M)
#
## equation 5.26 & 5.27
#PCH|O|[c] = P|V|S[c]*(1 + Tvat|O|[c]) / (1 + @elem(Tvat|O|[c], %baseyear)) if CH|O|[c] <> 0 where c in %list_com \ %list_com_E_CO2, (O, V) in (D M, YQ M)
#
#PCH|O|[ce2] = P|V|S[ce2]*(1 + Tvat|O|[ce2]) / (1 + @elem(Tvat|O|[ce2], %baseyear)) + Ttco[ce2]*EMS_HH[ce2]/EXP[ce2] if CH|O|[ce2] <> 0 where (O, V) in (D M, YQ M)
#
## equation 5.28 & 5.29
#PG|O|[c] = P|V|S[c]*((1 + Tvat|O|oth[c]) / (1 + @elem(Tvat|O|oth[c], %baseyear))) if G|O|[c] <> 0 where (O, V) in (D M, YQ M)
#
## equation 5.30 & 5.31
#PIA|O|[c] = P|V|S[c]*((1 + Tvat|O|oth[c]) / (1 + @elem(Tvat|O|oth[c], %baseyear))) if I|O|[c] <> 0 where (O, V) in (D M, YQ M)
#
## equation 5.32, 5.33, 5.34 & 5.35
#P|VV||O|[c] = P|V|S[c] if |VV||O|[c] <> 0 where VV in X DS, (O, V) in (D M, YQ M)
#
## equation 5.36
#PMTD[trsp, c] = YQ[trsp] / (YQ[trsp] + M[trsp]) * PYQS[trsp] + M[trsp] / (YQ[trsp]+M[trsp])*PMS[trsp] if MTD[trsp, c] <> 0 where c in %list_com \ %list_trsp_services
#
## equation 5.37
#PMTM[trsp, c] = PMTD[trsp, c] if MTM[trsp, c] <> 0 where c in %list_com \ %list_trsp_services
#
## equation 5.38
#PMCD[c] = YQ[ccm]/(YQ[ccm] + M[ccm])*PYQS[ccm] + M[ccm]/(YQ[ccm] + M[ccm])*PMS[ccm] if MCD[c] <> 0 where c in %list_com \ %list_trsp_services
#
## equation 5.39
#PMCM[c] = PMCD[c] if MCM[c] <> 0 where c in %list_com \ %list_trsp_services
#
## equation 5.40
#PM[c] = TC*PWD[c] if M[c] <> 0
#
## equation 5.41
#d(log(W_n[s])) = RHO($s,1) + RHO($s,2)*d(log(P_e)) + RHO($s,3)*d(log(PROG_L[s])) - RHO($s,4)*(sum(Y[c, s]{-1}/Y[s]{-1}*M[c]{-1}/(YQ[c]{-1}+M[c]{-1})*d(log(PM[c]/PY[s])) if Y[c, s] <> 0 on c)) - RHO($s,5)*UnR_TOT - RHO($s,6)*d(UnR_TOT) + RHO($s,7)*d(log(L_S[s]) - log(L))+DNAIRU*RHO($s,5) if W_S_n[s] <> 0
#
#d(log(W_SE[s])) = d(log(W_S[s])) if W_SE[s] <> 0
#
## TAYLOR RULE and interest rates
#
## equation 5.42
#d(R_n) = d(R_DIR)
#
#d(R_G) = d(R)
#
#d(R_DIR) = STEADYSTATE(37,1)*(d(infl_ZE)-d(infl_ZE_target)) - STEADYSTATE(38,1)*(d(UnR_ZE)-d(UnR_ZE_target)) #"Original" rule
#
#infl_FR = d(P)/P{-1}
#
#infl_ZE = STEADYSTATE(42,1)*infl_FR + (1 - STEADYSTATE(42,1))*infl_HFR
#
#infl_HFR = STEADYSTATE(41,1)*infl_FR + (1 - STEADYSTATE(41,1))*infl_HFR{-1}
#
#P = PCH
#
#UnR_FR = UnR_TOT
#
#UnR_ZE = STEADYSTATE(42,1)*UnR_FR + (1 - STEADYSTATE(42,1))*UnR_HFR
#
#UnR_HFR = STEADYSTATE(41,1)*UnR_FR + (1 - STEADYSTATE(41,1))*UnR_HFR{-1}
#
#d(R[s]) = d(R)
#
#d(log(P_e)) = ADJUST(68,2)*d(log(P_e{-1})) + (1-ADJUST(68,2))*d(log(P{-1})) - ADJUST(68,6)*log(P_e{-1}/P{-1})
#